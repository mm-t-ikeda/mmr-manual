<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>因子分析から回帰分析</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.13/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My ウェブサイト</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">ホーム</a>
</li>
<li>
  <a href="shumi.html">趣味</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">因子分析から回帰分析</h1>

</div>


<div id="概要" class="section level2">
<h2>概要</h2>
<ol style="list-style-type: decimal">
<li>データ読み込み</li>
<li>前処理として次元圧縮を行う<br />
</li>
<li>50の区市町を何らかの基準でクラスタに分けたい　…クラスタリング<br />
</li>
<li>人気度がどのような要因に基づくのかを分析したい…回帰分析</li>
</ol>
</div>
<div id="データ読み込み" class="section level2">
<h2>１．データ読み込み</h2>
<div id="ファイルを読み込んでデータフレームを作成する" class="section level3">
<h3>ファイルを読み込んでデータフレームを作成する</h3>
<pre class="r"><code>DF &lt;- read.table( &quot;TokyoSTAT_P25.csv&quot;,
                  sep = &quot;,&quot;,
                  header = TRUE,
                  stringsAsFactors = FALSE,
                  fileEncoding=&quot;UTF-8&quot;)     #文字コードはUTF-8
DT::datatable(DF)</code></pre>
<div id="htmlwidget-c54a92057228b7c65aaa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c54a92057228b7c65aaa">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],["千代田区","中央区","港区","新宿区","文京区","台東区","墨田区","江東区","品川区","目黒区","大田区","世田谷区","渋谷区","中野区","杉並区","豊島区","北区","荒川区","板橋区","練馬区","足立区","葛飾区","江戸川区","八王子市","立川市","武蔵野市","三鷹市","青梅市","府中市","昭島市","調布市","町田市","小金井市","小平市","日野市","東村山市","国分寺市","国立市","福生市","狛江市","東大和市","清瀬市","東久留米市","武蔵村山市","多摩市","稲城市","羽村市","あきる野市","西東京市","瑞穂町"],[13101,13102,13103,13104,13105,13106,13107,13108,13109,13110,13111,13112,13113,13114,13115,13116,13117,13118,13119,13120,13121,13122,13123,13201,13202,13203,13204,13205,13206,13207,13208,13209,13210,13211,13212,13213,13214,13215,13218,13219,13220,13221,13222,13223,13224,13225,13227,13228,13229,13303],[160,125,214,147,151,67,51,71,123,163,70,171,166,107,119,101,62,31,54,74,37,35,52,31,54,85,46,12,44,15,41,38,28,22,21,17,29,27,21,23,17,15,16,15,21,14,18,12,25,11],[1.8433,1.8058,1.8629,1.6697,1.849,1.8439,2.0498,2.1491,1.8625,1.944,2.0062,1.9537,1.6525,1.7081,1.8149,1.7127,1.9444,2.1141,1.965,2.1303,2.1722,2.2435,2.2331,2.3212,2.2204,1.9477,2.0632,2.6519,2.2186,2.3774,2.0719,2.3701,2.06,2.2869,2.2468,2.3999,2.0883,2.1112,2.211,2.0106,2.4687,2.394,2.3699,2.6149,2.3042,2.4348,2.4322,2.752,2.2469,2.7081],[0.1073,0.1054,0.1118,0.0766,0.0976,0.0856,0.1043,0.1206,0.0985,0.0958,0.1088,0.1091,0.0754,0.0737,0.0744,0.0781,0.093,0.1086,0.104,0.1218,0.1228,0.1209,0.1406,0.1243,0.1184,0.1039,0.1158,0.1291,0.1333,0.1294,0.1199,0.1355,0.1124,0.1271,0.1286,0.1289,0.1166,0.1198,0.1191,0.1078,0.1399,0.1282,0.1282,0.1553,0.1201,0.1527,0.1411,0.1405,0.1227,0.1388],[0.1916,0.1589,0.1698,0.1865,0.1853,0.2315,0.2131,0.1911,0.1912,0.1923,0.2021,0.1822,0.1891,0.1956,0.1987,0.1899,0.237,0.2149,0.2087,0.1922,0.2212,0.22,0.1794,0.2059,0.2124,0.1952,0.1867,0.2314,0.1814,0.2067,0.1878,0.2155,0.1847,0.1999,0.207,0.2235,0.1878,0.1899,0.2041,0.2158,0.2174,0.248,0.2341,0.2083,0.2093,0.1728,0.1952,0.2374,0.2034,0.211],[0.1572,0.1236,0.1065,0.0855,0.0827,0.078,0.0723,0.063,0.0735,0.0839,0.0597,0.0648,0.0976,0.0825,0.0714,0.0775,0.0641,0.0559,0.0578,0.0545,0.041,0.0426,0.0471,0.0358,0.0564,0.0747,0.0672,0.0301,0.0549,0.0416,0.0592,0.0386,0.0638,0.0527,0.0508,0.0373,0.0654,0.0585,0.0431,0.069,0.0469,0.0429,0.0401,0.0391,0.0413,0.0478,0.0403,0.0331,0.0514,0.035],[0.1046,0.0869,0.0878,0.0798,0.072,0.066,0.0582,0.0527,0.0658,0.0793,0.0512,0.0599,0.0883,0.0766,0.0655,0.0707,0.0565,0.0507,0.0517,0.0517,0.0356,0.0402,0.0441,0.036,0.0517,0.0671,0.0592,0.031,0.0521,0.0439,0.0592,0.0367,0.0633,0.0504,0.044,0.0403,0.061,0.0572,0.0477,0.0555,0.0369,0.0387,0.0391,0.0388,0.0422,0.0449,0.0422,0.032,0.0482,0.0347],[1738.8,493.6,432,229.9,167.2,167.5,112.8,119.1,144.3,109.3,98.7,92.7,254.6,91.9,87.4,148.6,95.8,94.3,92.1,82.1,89.1,85,84.1,99.7,113.1,110.5,89.4,91.4,96.4,89.3,87.7,91,86.4,88.8,88,81.6,83.5,97.5,86.3,74.9,79.4,83.4,80.1,92.2,98.6,79.6,93.3,86.7,80,108.3],[0.0966,0.0809,0.0919,0.1048,0.0979,0.1168,0.1042,0.096,0.0989,0.0926,0.1004,0.0896,0.1027,0.0986,0.1167,0.1053,0.1305,0.113,0.1088,0.0883,0.115,0.1076,0.0829,0.0805,0.0932,0.0968,0.0842,0.0761,0.0786,0.0926,0.0867,0.0894,0.0856,0.0888,0.0844,0.0974,0.0777,0.0919,0.0991,0.1006,0.0928,0.1137,0.1098,0.0848,0.0835,0.0697,0.0743,0.0754,0.0877,0.0706],[0.0001,0.0002,0.0001,0.0001,0,0.0001,0,0.0002,0.0001,0.0007,0.0003,0.0007,0.0002,0.0025,0.0005,0.0001,0.0002,0,0.0005,0.0006,0.0005,0.0003,0.0008,0.0011,0.0003,0.0002,0.0006,0.0025,0.0009,0.0012,0.0007,0.0018,0.001,0.0014,0.0003,0.0007,0.0016,0.0001,0.0009,0.0018,0.0009,0.0005,0.0024,0.0012,0.0007,0.0035,0.0008,0.0021,0.0005,0.0014],[0.1054,0.1195,0.1534,0.1087,0.1443,0.1606,0.2348,0.1714,0.1643,0.124,0.2299,0.0867,0.0822,0.1162,0.0964,0.096,0.1874,0.2497,0.2191,0.1544,0.222,0.2257,0.2096,0.1875,0.0948,0.1034,0.1859,0.2941,0.1979,0.26,0.1217,0.1235,0.0858,0.2513,0.3049,0.1596,0.103,0.065,0.1642,0.189,0.1597,0.1063,0.2052,0.2754,0.0788,0.2322,0.3431,0.1997,0.1437,0.4054],[0.8945,0.8803,0.8465,0.8912,0.8557,0.8393,0.7652,0.8284,0.8356,0.8753,0.7698,0.9126,0.9175,0.8812,0.903,0.9039,0.8124,0.7503,0.7805,0.845,0.7776,0.7741,0.7896,0.8114,0.9049,0.8964,0.8135,0.7034,0.8012,0.7388,0.8776,0.8748,0.9132,0.7473,0.6948,0.8398,0.8954,0.9349,0.8348,0.8092,0.8394,0.8932,0.7924,0.7234,0.9205,0.7643,0.6561,0.7982,0.8558,0.5932],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.5715,0.9922,1,0.9988,0.3687,0.9973,0.9862,0.9954,0.8896,0.9938,0.9976,0.9637,0.9586,0.9948,1,0.9793,0.9969,0.8495,0.9902,0.9992,0.8877,0.9829,0.8564,0.9869,0.3983,0.9924,0.8315],[0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0101,0.0742,0.1233,0.031,0.0951,0.1239,0.0589,0.0456,0.0722,0.0813,0.0703,0.1056,0.0633,0.1077,0.1351,0.0773,0.0151,0.0628,0.0693,0.2063,0.1391,0.1493,0.0194,0.089,0.043,0.1452,0.1081,0.1899],[11449.581,6737.9314,16954.8785,6040.9687,6630.5134,4345.2555,3797.2741,4248.9747,5077.2037,7649.9095,4546.5052,6201.5025,10049.4541,4805.6791,5638.4014,4696.6204,3819.0598,3584.1948,3968.7357,4354.9914,3290.3684,3497.2497,3582.3496,3491.8402,3712.4857,5714.612,4557.8912,3227.9362,3842.0424,3151.6134,4300.4656,4012.6833,4611.9487,3898.4642,3732.5926,3643.7896,4497.5532,4845.7116,3106.2402,3987.0942,3385.0946,3358.5241,3412.2134,2865.3362,3838.4072,3973.0862,3191.7312,3115.2812,3934.9925,2830.8943],[383.3745,610.7298,391.3318,422.1306,104.3095,207.4598,138.2319,200.1558,245.0704,150.4508,146.5542,172.2936,314.1896,155.9564,125.7487,485.1055,96.3835,81.093,151.0082,152.79,145.0647,111.4111,156.138,213.0997,252.4459,179.3885,182.0279,136.264,197.865,190.2745,205.6509,228.9161,158.8166,156.0076,159.1631,153.9804,180.931,122.7395,130.0842,114.9885,176.1223,121.9694,195.4604,174.3766,240.0478,230.4361,150.529,121.2401,146.926,267.3207],[233.971,244.1373,377.0145,213.1701,163.6207,211.5546,114.2827,110.6404,211.3705,159.1183,149.4799,149.7659,169.1241,174.4269,142.9701,229.7298,112.7964,110.6266,118.8551,116.3391,108.4705,113.2698,108.4485,91.1894,104.4262,110.9999,134.299,68.9452,93.817,72.4996,127.9853,113.2434,86.8802,107.0423,110.8512,110.3965,107.1826,89.3115,76.1851,101.5197,86.3761,110.8264,91.5548,79.2097,91.658,90.0684,92.5178,76.8658,94.4397,89.1166],[211080,211614,207795,196377,217984,210835,224527,235694,236408,210350,242504,208766,206082,202210,206478,197819,240028,221261,229120,210108,227549,225040,227248,228498,223395,213094,214121,231509,221207,228310,215676,232233,221566,221265,235643,236018,220144,209567,207734,222147,222224,249198,222955,225973,236659,221425,229659,215389,219320,207371],[18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,18.3,34.4,39.5,40.2,41.8,36.3,41,35.5,45.3,32.5,52.4,35.2,36.1,42.7,44.9,35.6,36.7,37.3,37.6,29.4,40.7,34.6,34.2,31.3,37.3,25.8,43.7,33.6],[754.8764,337.6778,207.9842,107.7322,77.241,150.5389,73.0354,44.039,61.8228,47.3559,48.9361,28.235,129.6872,45.6458,39.5983,66.5102,44.8823,53.8673,39.3077,30.9765,42.3499,45.442,34.7572,34.1831,45.662,58.5581,31.3462,36.544,32.285,35.4506,32.1164,30.1063,26.1081,26.6421,27.1921,26.7783,31.264,37.346,38.4641,29.5488,34.1287,27.205,26.0584,38.2567,27.0711,26.7932,39.2937,33.0662,28.9907,50.2135],[0.2547,0.1303,0.1462,0.1042,0.1355,0.1137,0.0646,0.0716,0.0739,0.0894,0.0692,0.0775,0.0978,0.0794,0.0873,0.0703,0.1043,0.0689,0.0672,0.0628,0.0805,0.0723,0.0633,0.0534,0.0668,0.0865,0.0914,0.0431,0.0783,0.0623,0.0671,0.0843,0.0589,0.0802,0.0833,0.0716,0.0414,0.1192,0.0669,0.0508,0.0361,0.0945,0.0686,0.0571,0.061,0.0825,0.1227,0.0742,0.0662,0.0896],[79.2953,44.2727,27.7871,17.6918,7.366,17.7459,7.2898,4.6786,7.205,5.5901,5.1069,3.5889,15.8099,5.2581,5.1258,8.9224,5.3406,5.1747,4.1973,2.8529,4.0663,4.5302,3.2785,3.6928,5.833,8.7794,2.7945,3.5166,3.5655,4.3723,3.8999,3.1734,2.9953,2.8818,2.6104,3.2496,4.484,4.2776,6.4386,2.7428,3.7439,3.0093,2.2824,3.4117,2.7227,2.2632,6.435,2.807,3.1601,2.4181],[1.9102,0.8879,0.4972,0.3432,0.092,0.1876,0.1292,0.1411,0.1697,0.1081,0.1284,0.1265,0.6015,0.1207,0.0801,0.2143,0.1073,0.1082,0.1194,0.0964,0.1288,0.0926,0.1075,0.169,0.1781,0.2162,0.1075,0.1148,0.1292,0.1425,0.1118,0.1382,0.1178,0.0909,0.0889,0.0977,0.1326,0.1589,0.1003,0.0889,0.1083,0.054,0.1201,0.0999,0.1964,0.165,0.1227,0.1113,0.0967,0.1791],[0.3184,0.0326,0.0731,0.049,0.0532,0.0455,0.0565,0.0369,0.0356,0.0335,0.0418,0.0296,0.0782,0.0318,0.0309,0.0527,0.0626,0.0689,0.0765,0.0265,0.0746,0.0452,0.0339,0.069,0.039,0.0721,0.043,0.1148,0.0587,0.0712,0.0358,0.0468,0.0421,0.0481,0.0333,0.0716,0.0166,0.0265,0.0669,0.0254,0.0241,0.1754,0.0257,0.0571,0.0542,0.0354,0.0351,0.0495,0.0254,0.0299],[0.0637,0.057,0.039,0.0398,0.0484,0.0455,0.0323,0.0347,0.0411,0.0634,0.049,0.0547,0.0293,0.0477,0.0582,0.0351,0.0358,0.0394,0.0504,0.06,0.0658,0.061,0.0501,0.0759,0.0835,0.0793,0.0806,0.1938,0.0665,0.089,0.0447,0.0632,0.0589,0.0535,0.0666,0.0977,0.058,0.0397,0.1003,0.0635,0.0602,0.1484,0.0601,0.0428,0.0745,0.0825,0.0877,0.2102,0.0814,0.1194],[29.0141,9.8646,11.9631,6.0342,4.2783,6.0593,4.2083,3.854,3.3753,4.092,3.8464,4.2,9.5652,2.8308,3.803,3.5057,2.6345,2.8727,3.712,3.4784,3.7663,3.9427,3.4273,4.5858,5.0593,3.7626,3.0685,4.7941,3.9764,4.1942,3.8418,4.4732,3.6179,3.7212,2.8325,3.7185,3.2076,4.5424,6.3382,2.8571,5.2126,2.8204,3.8869,6.5522,3.9689,3.3123,4.6465,4.2415,3.6792,9.165],[95.1714,28.706,27.8066,33.1986,11.7217,32.2291,16.2799,14.5741,13.7338,11.8623,13.593,12.1144,37.9868,15.9778,12.9101,27.4521,14.7432,15.9374,15.2326,13.5298,16.666,13.873,15.1819,16.2399,22.7976,23.6568,10.5007,10.1981,11.4753,17.9791,12.1202,12.4407,12.4609,13.6499,9.3251,12.6598,13.6842,19.9841,16.3054,9.9046,17.0222,16.3419,12.021,14.9173,11.8661,9.2415,14.8338,9.4722,14.0755,19.2853]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>市町村<\/th>\n      <th>行政CD<\/th>\n      <th>人気度<\/th>\n      <th>世帯あたり人数<\/th>\n      <th>年齢15未満比率<\/th>\n      <th>年齢65以上比率<\/th>\n      <th>転入者_対人口比<\/th>\n      <th>転出者_対人口比<\/th>\n      <th>昼間人口比_per<\/th>\n      <th>高齢単身世帯比率<\/th>\n      <th>第1次産業従業者数比<\/th>\n      <th>第2次産業従業者数比<\/th>\n      <th>第3次産業従業者数比<\/th>\n      <th>可住地面積比率<\/th>\n      <th>耕地面積_対可住面積比<\/th>\n      <th>課税所得_就業者1人あたり_千円<\/th>\n      <th>小売業販売額_事業所あたり_百万円<\/th>\n      <th>小売業販売額_売場面積あたり_万円m2<\/th>\n      <th>国民健保一人あたり診療費_円<\/th>\n      <th>ごみリサイクル率_pct<\/th>\n      <th>千人あたり事業所数<\/th>\n      <th>千人あたり幼稚園数<\/th>\n      <th>千人あたり飲食店数<\/th>\n      <th>千人あたり大型小売店数<\/th>\n      <th>千人あたり病院数<\/th>\n      <th>千人あたり老人ホーム数<\/th>\n      <th>千人あたり交通事故発生件数<\/th>\n      <th>千人あたり刑法犯認知件数<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>str(DF) #Structure</code></pre>
<pre><code>## &#39;data.frame&#39;:    50 obs. of  28 variables:
##  $ 市町村                            : chr  &quot;千代田区&quot; &quot;中央区&quot; &quot;港区&quot; &quot;新宿区&quot; ...
##  $ 行政CD                            : int  13101 13102 13103 13104 13105 13106 13107 13108 13109 13110 ...
##  $ 人気度                            : int  160 125 214 147 151 67 51 71 123 163 ...
##  $ 世帯あたり人数                    : num  1.84 1.81 1.86 1.67 1.85 ...
##  $ 年齢15未満比率                    : num  0.1073 0.1054 0.1118 0.0766 0.0976 ...
##  $ 年齢65以上比率                    : num  0.192 0.159 0.17 0.186 0.185 ...
##  $ 転入者_対人口比                   : num  0.1572 0.1236 0.1065 0.0855 0.0827 ...
##  $ 転出者_対人口比                   : num  0.1046 0.0869 0.0878 0.0798 0.072 ...
##  $ 昼間人口比_per                    : num  1739 494 432 230 167 ...
##  $ 高齢単身世帯比率                  : num  0.0966 0.0809 0.0919 0.1048 0.0979 ...
##  $ 第1次産業従業者数比               : num  1e-04 2e-04 1e-04 1e-04 0e+00 1e-04 0e+00 2e-04 1e-04 7e-04 ...
##  $ 第2次産業従業者数比               : num  0.105 0.119 0.153 0.109 0.144 ...
##  $ 第3次産業従業者数比               : num  0.894 0.88 0.847 0.891 0.856 ...
##  $ 可住地面積比率                    : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ 耕地面積_対可住面積比             : num  0.0101 0.0101 0.0101 0.0101 0.0101 0.0101 0.0101 0.0101 0.0101 0.0101 ...
##  $ 課税所得_就業者1人あたり_千円     : num  11450 6738 16955 6041 6631 ...
##  $ 小売業販売額_事業所あたり_百万円  : num  383 611 391 422 104 ...
##  $ 小売業販売額_売場面積あたり_万円m2: num  234 244 377 213 164 ...
##  $ 国民健保一人あたり診療費_円       : int  211080 211614 207795 196377 217984 210835 224527 235694 236408 210350 ...
##  $ ごみリサイクル率_pct              : num  18.3 18.3 18.3 18.3 18.3 18.3 18.3 18.3 18.3 18.3 ...
##  $ 千人あたり事業所数                : num  754.9 337.7 208 107.7 77.2 ...
##  $ 千人あたり幼稚園数                : num  0.255 0.13 0.146 0.104 0.136 ...
##  $ 千人あたり飲食店数                : num  79.3 44.27 27.79 17.69 7.37 ...
##  $ 千人あたり大型小売店数            : num  1.91 0.888 0.497 0.343 0.092 ...
##  $ 千人あたり病院数                  : num  0.3184 0.0326 0.0731 0.049 0.0532 ...
##  $ 千人あたり老人ホーム数            : num  0.0637 0.057 0.039 0.0398 0.0484 0.0455 0.0323 0.0347 0.0411 0.0634 ...
##  $ 千人あたり交通事故発生件数        : num  29.01 9.86 11.96 6.03 4.28 ...
##  $ 千人あたり刑法犯認知件数          : num  95.2 28.7 27.8 33.2 11.7 ...</code></pre>
<pre class="r"><code>summary(DF[, -c(1:2)])</code></pre>
<pre><code>##      人気度       世帯あたり人数  年齢15未満比率   年齢65以上比率  
##  Min.   : 11.00   Min.   :1.653   Min.   :0.0737   Min.   :0.1589  
##  1st Qu.: 21.00   1st Qu.:1.945   1st Qu.:0.1046   1st Qu.:0.1893  
##  Median : 39.50   Median :2.122   Median :0.1195   Median :0.2010  
##  Mean   : 61.38   Mean   :2.138   Mean   :0.1154   Mean   :0.2023  
##  3rd Qu.: 82.25   3rd Qu.:2.317   3rd Qu.:0.1285   3rd Qu.:0.2145  
##  Max.   :214.00   Max.   :2.752   Max.   :0.1553   Max.   :0.2480  
##  転入者_対人口比   転出者_対人口比   昼間人口比_per    高齢単身世帯比率 
##  Min.   :0.03010   Min.   :0.03100   Min.   :  74.90   Min.   :0.06970  
##  1st Qu.:0.04267   1st Qu.:0.04220   1st Qu.:  86.47   1st Qu.:0.08450  
##  Median :0.05710   Median :0.05170   Median :  92.15   Median :0.09270  
##  Mean   :0.06119   Mean   :0.05500   Mean   : 150.96   Mean   :0.09412  
##  3rd Qu.:0.07208   3rd Qu.:0.06495   3rd Qu.: 110.20   3rd Qu.:0.10218  
##  Max.   :0.15720   Max.   :0.10460   Max.   :1738.80   Max.   :0.13050  
##  第1次産業従業者数比 第2次産業従業者数比 第3次産業従業者数比 可住地面積比率  
##  Min.   :0.000000    Min.   :0.0650      Min.   :0.5932      Min.   :0.3687  
##  1st Qu.:0.000200    1st Qu.:0.1106      1st Qu.:0.7783      1st Qu.:0.9864  
##  Median :0.000600    Median :0.1624      Median :0.8375      Median :0.9996  
##  Mean   :0.000798    Mean   :0.1741      Mean   :0.8251      Mean   :0.9492  
##  3rd Qu.:0.001075    3rd Qu.:0.2213      3rd Qu.:0.8887      3rd Qu.:1.0000  
##  Max.   :0.003500    Max.   :0.4054      Max.   :0.9349      Max.   :1.0000  
##  耕地面積_対可住面積比 課税所得_就業者1人あたり_千円
##  Min.   :0.01010       Min.   : 2831                
##  1st Qu.:0.01010       1st Qu.: 3519                
##  Median :0.02520       Median : 3971                
##  Mean   :0.05467       Mean   : 4744                
##  3rd Qu.:0.08707       3rd Qu.: 4778                
##  Max.   :0.20630       Max.   :16955                
##  小売業販売額_事業所あたり_百万円 小売業販売額_売場面積あたり_万円m2
##  Min.   : 81.09                   Min.   : 68.95                    
##  1st Qu.:145.44                   1st Qu.: 91.87                    
##  Median :165.73                   Median :110.73                    
##  Mean   :198.68                   Mean   :129.05                    
##  3rd Qu.:211.69                   3rd Qu.:147.85                    
##  Max.   :610.73                   Max.   :377.01                    
##  国民健保一人あたり診療費_円 ごみリサイクル率_pct 千人あたり事業所数
##  Min.   :196377              Min.   :18.30        Min.   : 26.06    
##  1st Qu.:210896              1st Qu.:18.30        1st Qu.: 31.05    
##  Median :221345              Median :30.35        Median : 38.36    
##  Mean   :220784              Mean   :28.73        Mean   : 68.46    
##  3rd Qu.:228451              3rd Qu.:37.15        3rd Qu.: 49.89    
##  Max.   :249198              Max.   :52.40        Max.   :754.88    
##  千人あたり幼稚園数 千人あたり飲食店数 千人あたり大型小売店数 千人あたり病院数 
##  Min.   :0.03610    Min.   : 2.263     Min.   :0.0540         Min.   :0.01660  
##  1st Qu.:0.06635    1st Qu.: 3.163     1st Qu.:0.1074         1st Qu.:0.03335  
##  Median :0.07405    Median : 4.237     Median :0.1217         Median :0.04535  
##  Mean   :0.08286    Mean   : 7.875     Mean   :0.1987         Mean   :0.05560  
##  3rd Qu.:0.08955    3rd Qu.: 6.285     3rd Qu.:0.1680         3rd Qu.:0.06582  
##  Max.   :0.25470    Max.   :79.295     Max.   :1.9102         Max.   :0.31840  
##  千人あたり老人ホーム数 千人あたり交通事故発生件数 千人あたり刑法犯認知件数
##  Min.   :0.02930        Min.   : 2.635             Min.   : 9.242          
##  1st Qu.:0.04605        1st Qu.: 3.534             1st Qu.:12.200          
##  Median :0.06005        Median : 3.915             Median :14.659          
##  Mean   :0.06767        Mean   : 5.008             Mean   :17.899          
##  3rd Qu.:0.07845        3rd Qu.: 4.631             3rd Qu.:16.933          
##  Max.   :0.21020        Max.   :29.014             Max.   :95.171</code></pre>
</div>
</div>
<div id="因子分析による次元削減" class="section level2">
<h2>２．因子分析による次元削減</h2>
<div id="並行分析で因子数を検討" class="section level3">
<h3>並行分析で因子数を検討</h3>
<ul>
<li>最適な因子数、主成分分析の主成分数を見つけるため、平行分析を行う</li>
<li>fa.parallel：平行分析（PA）の実施（視覚的に適切な因子数を判断）</li>
<li>fm＝因子抽出法（minres最小残差法、pa主因子法、ml最尤法）</li>
<li>ここでは最尤法を選択</li>
<li>1-2列目はIDなので除く</li>
<li>3列目は次元圧縮の対象ではないので除く</li>
</ul>
<pre class="r"><code>result.prl &lt;- fa.parallel(DF[, -(1:3)], fm=&quot;ml&quot;)</code></pre>
<pre><code>## In smc, smcs &lt; 0 were set to .0
## In smc, smcs &lt; 0 were set to .0</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" width="768" /></p>
<pre><code>## Parallel analysis suggests that the number of factors =  2  and the number of components =  2</code></pre>
</div>
<div id="fa因子分析の実行" class="section level3">
<h3>FA（因子分析）の実行</h3>
<ul>
<li>fa：因子分析の実行</li>
<li>fm＝因子抽出法（minres最小残差法、pa主因子法、ml最尤法）</li>
<li>ここでは最尤法を選択</li>
<li>nfactors＝因子数（抽出したい軸の数）</li>
<li>rotate＝回転法（直交回転:varimax等、斜交回転:promax等）</li>
<li>scores＝因子得点算出法</li>
<li>1-2列目はIDなので除く</li>
<li>3列目は次元圧縮の対象ではないので除く</li>
</ul>
<pre class="r"><code>resultFA &lt;- fa(DF[, -(1:3)],
               nfactors=3,             #因子数を指定
               fm = &quot;ml&quot;,              #pa 主因子法, ols 最小二乗法, ml 最尤法
               rotate = &quot;varimax&quot;,     #varimax 直交、promax 斜交
               scores = &quot;regression&quot;)  #regression 回帰法</code></pre>
<pre><code>## In smc, smcs &lt; 0 were set to .0
## In smc, smcs &lt; 0 were set to .0</code></pre>
</div>
<div id="fa結果の表示" class="section level3">
<h3>FA結果の表示</h3>
<ul>
<li>digits＝小数点以下表示桁の指定</li>
<li>sort=TRUEを指定（各項目ごとの因子負荷量がソートされる）</li>
<li>MRi…：各項目ごとの因子負荷量（各変数がどれだけ因子に寄与しているか）</li>
<li>h2：共通性–各変数の値の変動が因子でどれだけ説明できるかを表す</li>
<li>u2＝1-h2：独自性（uniqueness）–取りこぼしの度合（救えなかった情報）</li>
</ul>
<pre class="r"><code>print(resultFA, digits=2, sort=TRUE)</code></pre>
<pre><code>## Factor Analysis using method =  ml
## Call: fa(r = DF[, -(1:3)], nfactors = 3, rotate = &quot;varimax&quot;, scores = &quot;regression&quot;, 
##     fm = &quot;ml&quot;)
## Standardized loadings (pattern matrix) based upon correlation matrix
##                                    item   ML1   ML2   ML3   h2     u2 com
## 千人あたり事業所数                   18  0.97  0.16  0.14 1.00 0.0046 1.1
## 昼間人口比_per                        6  0.97  0.11  0.12 0.97 0.0310 1.1
## 千人あたり大型小売店数               21  0.95  0.12  0.20 0.97 0.0327 1.1
## 千人あたり飲食店数                   20  0.95  0.22  0.19 0.98 0.0171 1.2
## 千人あたり交通事故発生件数           24  0.95  0.00  0.14 0.92 0.0828 1.0
## 千人あたり刑法犯認知件数             25  0.91  0.23  0.05 0.88 0.1202 1.1
## 千人あたり幼稚園数                   19  0.80  0.24  0.14 0.71 0.2866 1.2
## 千人あたり病院数                     22  0.79 -0.01 -0.26 0.70 0.3041 1.2
## 転入者_対人口比                       4  0.65  0.62  0.41 0.98 0.0240 2.7
## 課税所得_就業者1人あたり_千円        13  0.50  0.43  0.43 0.62 0.3763 2.9
## 小売業販売額_事業所あたり_百万円     14  0.49  0.17  0.45 0.47 0.5291 2.2
## 世帯あたり人数                        1 -0.16 -0.92 -0.28 0.95 0.0503 1.3
## 年齢15未満比率                        2 -0.06 -0.90 -0.09 0.83 0.1685 1.0
## 高齢単身世帯比率                      7  0.03  0.74 -0.65 0.96 0.0368 2.0
## 転出者_対人口比                       5  0.48  0.71  0.49 0.97 0.0283 2.6
## 耕地面積_対可住面積比                12 -0.13 -0.64 -0.11 0.45 0.5545 1.1
## 千人あたり老人ホーム数               23  0.01 -0.63 -0.16 0.43 0.5710 1.1
## 可住地面積比率                       11  0.01  0.60  0.06 0.36 0.6361 1.0
## 小売業販売額_売場面積あたり_万円m2   15  0.44  0.58  0.34 0.65 0.3502 2.5
## 第3次産業従業者数比                  10  0.09  0.54  0.23 0.35 0.6497 1.4
## 第1次産業従業者数比                   8 -0.20 -0.54  0.08 0.34 0.6636 1.3
## 第2次産業従業者数比                   9 -0.09 -0.54 -0.23 0.35 0.6536 1.4
## ごみリサイクル率_pct                 17 -0.24 -0.53  0.11 0.36 0.6444 1.5
## 年齢65以上比率                        3 -0.10 -0.19 -0.85 0.77 0.2337 1.1
## 国民健保一人あたり診療費_円          16 -0.15 -0.34 -0.48 0.36 0.6383 2.0
## 
##                        ML1  ML2  ML3
## SS loadings           8.22 6.34 2.75
## Proportion Var        0.33 0.25 0.11
## Cumulative Var        0.33 0.58 0.69
## Proportion Explained  0.47 0.37 0.16
## Cumulative Proportion 0.47 0.84 1.00
## 
## Mean item complexity =  1.5
## Test of the hypothesis that 3 factors are sufficient.
## 
## The degrees of freedom for the null model are  300  and the objective function was  62.46 with Chi Square of  2488.15
## The degrees of freedom for the model are 228  and the objective function was  29.15 
## 
## The root mean square of the residuals (RMSR) is  0.07 
## The df corrected root mean square of the residuals is  0.08 
## 
## The harmonic number of observations is  50 with the empirical chi square  152.33  with prob &lt;  1 
## The total number of observations was  50  with Likelihood Chi Square =  1102.82  with prob &lt;  1.2e-114 
## 
## Tucker Lewis Index of factoring reliability =  0.442
## RMSEA index =  0.276  and the 90 % confidence intervals are  0.263 0.296
## BIC =  210.88
## Fit based upon off diagonal values = 0.98
## Measures of factor score adequacy             
##                                                    ML1  ML2  ML3
## Correlation of (regression) scores with factors   1.00 0.99 0.98
## Multiple R square of scores with factors          1.00 0.98 0.96
## Minimum correlation of possible factor scores     0.99 0.97 0.93</code></pre>
</div>
<div id="fa結果を図で表示" class="section level3">
<h3>FA結果を図で表示</h3>
<pre class="r"><code>fa.diagram(resultFA,
           rsize=0.8, e.size=0.1, #四角と円のサイズ
           marg=c(.5,5,.5,.5),    #余白の設定
           cex=1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<pre class="r"><code>#文字サイズ</code></pre>
</div>
<div id="因子負荷量をプロットする" class="section level3">
<h3>因子負荷量をプロットする</h3>
<ul>
<li>因子負荷量（変数ごとの因子への寄与）の値をタテヨコにプロットする。</li>
<li>どの変数がどの因子に寄与しているかを把握できる。</li>
<li>第1因子と第2因子</li>
</ul>
<pre class="r"><code>#枠のみを作成する
#   type=&quot;n&quot;で点を描かない
# 　因子負荷量は、resultFAの中のloadingsに格納されている
plot(resultFA$loadings[, 1],
     resultFA$loadings[, 2], type=&quot;n&quot;)
#枠内にテキストを表示する
#   テキストは因子負荷量のリストの行の名前を取得して使う
text(resultFA$loadings[, 1],
     resultFA$loadings[, 2],
     rownames(resultFA$loadings), col=&quot;steelblue&quot;)
#y=0の直線を引く
#   点(-1, 0)から点(1, 0)まで線を引けばよい
#   lines(X, Y)でXとYのベクトルを指定する（散布図と同じ）
lines(c(-1, 1), c(0, 0), col=&quot;grey&quot;)
#x=0の直線を引く
#   点(0, -1)から点(0, 1)まで線を引けばよい
lines(c(0, 0), c(-1, 1), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<ul>
<li>第3因子と第2因子についても同様</li>
</ul>
<pre class="r"><code>plot(resultFA$loadings[, 3],
     resultFA$loadings[, 2], type=&quot;n&quot;)
text(resultFA$loadings[, 3],
     resultFA$loadings[, 2],
     rownames(resultFA$loadings), col=&quot;steelblue&quot;)
lines(c(-1, 1), c(0, 0), col=&quot;grey&quot;)
lines(c(0, 0), c(-1, 1), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
<div id="因子得点を確認" class="section level3">
<h3>因子得点を確認</h3>
<pre class="r"><code>#因子得点(ケースごとの得点)はresultFAの中のscoresに格納されている
head(resultFA$scores)</code></pre>
<pre><code>##             ML1         ML2        ML3
## [1,]  6.2894840 -0.02794331 -0.1492526
## [2,]  1.9786426  0.38104655  2.1070813
## [3,]  0.9592143  0.89862833  1.6079372
## [4,]  0.1090359  1.56183037  0.5496946
## [5,] -0.2597478  1.05473972  0.6796176
## [6,]  0.5593991  1.39390666 -1.1519543</code></pre>
<pre class="r"><code>#因子得点をデータフレームに変換
DFfa &lt;- as.data.frame(resultFA$scores)
#行の名前を自治体名に変換
rownames(DFfa) &lt;- DF$市町村

#意味を考えて因子に名前を付ける
names(DFfa) = c(&quot;ビジネス度&quot;,&quot;都会生活度&quot;,&quot;非高齢化度&quot;)
DT::datatable(DFfa)</code></pre>
<div id="htmlwidget-801474b7a71c28ffd64e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-801474b7a71c28ffd64e">{"x":{"filter":"none","data":[["千代田区","中央区","港区","新宿区","文京区","台東区","墨田区","江東区","品川区","目黒区","大田区","世田谷区","渋谷区","中野区","杉並区","豊島区","北区","荒川区","板橋区","練馬区","足立区","葛飾区","江戸川区","八王子市","立川市","武蔵野市","三鷹市","青梅市","府中市","昭島市","調布市","町田市","小金井市","小平市","日野市","東村山市","国分寺市","国立市","福生市","狛江市","東大和市","清瀬市","東久留米市","武蔵村山市","多摩市","稲城市","羽村市","あきる野市","西東京市","瑞穂町"],[6.28948403268094,1.97864256137738,0.959214297493389,0.10903589818109,-0.259747763697191,0.559399103913762,-0.0617892422617706,-0.240678229038658,-0.288549728997687,-0.544046905207766,-0.215876884373727,-0.540370850605175,0.281970776737328,-0.611882336618788,-0.462086567784178,-0.289167750191512,-0.158790380212919,-0.0880001434757139,-0.253594104013375,-0.403819103554032,0.0221197602446067,-0.0299074544744708,-0.279638734924813,-0.0996027151822194,-0.120982447268064,-0.232407270217826,-0.502380801248098,0.0893938708763131,-0.355470048836003,-0.0884981911223027,-0.457024127421044,-0.11450759675568,-0.553184195455516,-0.319536519064422,-0.308801300217863,-0.117537078697428,-0.516110738873155,-0.325491025696146,-0.117019435862323,-0.447201385754239,-0.069863461607334,0.0139751227165531,-0.0962424025749399,0.0177549573330595,-0.233289649495408,-0.317952029422044,-0.0822539298327209,0.0454090194491321,-0.322048267574538,0.158951396607531],[-0.027943310043571,0.38104654781031,0.898628325299096,1.56183037049689,1.05473972333544,1.3939066615293,0.672994937678808,0.130947097579091,0.898061835943721,0.99672656393097,0.38305718480625,0.370636855482713,1.65297411969134,1.44245241294916,1.64646416596761,1.46411823519751,1.62350066989085,0.632548716563208,0.708038457599796,-0.151850084208934,0.179952447204323,-0.011746279229062,-0.735717800664681,-1.20080549799553,-0.177893359088735,0.707327371316254,-0.0133859674928825,-1.9630367903536,-0.681060882835624,-0.68541309478775,-0.0224916236336486,-0.897004347489064,0.0880237582539488,-0.440674132605347,-0.656138254315597,-0.604363492615269,-0.249775538560455,0.0768441758620359,-0.182395884935587,0.549932717297203,-0.829831656427831,-0.0553153218876954,-0.203536250290051,-1.41610429290132,-0.80013483316731,-1.49516391264399,-1.4190051348197,-2.01019545854641,-0.448403350002854,-2.13536680014333],[-0.149252647127912,2.10708129302235,1.60793722229145,0.549694633529941,0.679617594765732,-1.15195434392395,-0.456425648884814,-0.0123449887376978,0.374909817587435,1.27254166354117,-0.407313613057296,0.839490794933218,0.928203919940559,0.915824766913898,-0.605686998062838,0.312924694448964,-2.17292780186112,-1.35845489125688,-0.924830709705667,0.388820742446733,-2.06847334994835,-1.50602990087959,0.391400397232607,-0.0453474484997621,-0.103114461909279,0.47991063860325,1.05033387007716,-0.362901818423385,0.96348799056692,-0.523585755164964,0.813508453264374,-0.497713092513313,1.05823409300114,0.169760217872396,0.178002575844678,-1.00531495930978,1.46319292789025,0.375286668269793,-0.674331801493847,-0.128087104380579,-0.635234901852858,-2.22685897028925,-1.66428795145249,-0.311482657254018,0.0540834704021981,1.26492034368487,0.515287871064244,-0.220040613756323,0.182752146607433,0.274787621943198]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ビジネス度<\/th>\n      <th>都会生活度<\/th>\n      <th>非高齢化度<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>#因子得点について要約情報を表示
summary(DFfa)</code></pre>
<pre><code>##    ビジネス度         都会生活度         非高齢化度     
##  Min.   :-0.61188   Min.   :-2.13537   Min.   :-2.2269  
##  1st Qu.:-0.32142   1st Qu.:-0.67483   1st Qu.:-0.5171  
##  Median :-0.18733   Median :-0.01794   Median : 0.1119  
##  Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.:-0.03788   3rd Qu.: 0.69874   3rd Qu.: 0.6471  
##  Max.   : 6.28948   Max.   : 1.65297   Max.   : 2.1071</code></pre>
<pre class="r"><code>#標準偏差
apply(DFfa, 2, sd)</code></pre>
<pre><code>## ビジネス度 都会生活度 非高齢化度 
##  0.9975681  0.9918187  0.9815127</code></pre>
</div>
</div>
<div id="因子得点をもとにクラスタリング" class="section level2">
<h2>３．因子得点をもとにクラスタリング</h2>
<div id="kmeans因子得点でクラスタリング" class="section level3">
<h3>kMeans×因子得点でクラスタリング</h3>
<pre class="r"><code>kmFA &lt;- kmeans(DFfa, 4, iter.max=50)

#色ラベルの配列を作るためにクラスタ番号の配列をコピー
color.kmFA &lt;- kmFA$cluster
head(color.kmFA)</code></pre>
<pre><code>## 千代田区   中央区     港区   新宿区   文京区   台東区 
##        1        4        4        4        4        3</code></pre>
<pre class="r"><code>#クラスタ番号を色名に変換する
#levels＝factor（カテゴリ変数）のラベルの指定
#クラスタの数に注意
color.kmFA &lt;- as.factor(color.kmFA)
levels(color.kmFA) &lt;- c(&quot;blue&quot;, &quot;red&quot;, &quot;green&quot;, &quot;orange&quot;)
head(color.kmFA)</code></pre>
<pre><code>## 千代田区   中央区     港区   新宿区   文京区   台東区 
##     blue   orange   orange   orange   orange    green 
## Levels: blue red green orange</code></pre>
<pre class="r"><code>#factorの実体は整数型なので文字列に変換（ラベルの値が実体となる）
color.kmFA &lt;- as.character(color.kmFA)
head(color.kmFA)</code></pre>
<pre><code>## [1] &quot;blue&quot;   &quot;orange&quot; &quot;orange&quot; &quot;orange&quot; &quot;orange&quot; &quot;green&quot;</code></pre>
<pre class="r"><code>#因子得点(サンプルごとの点数)の値を色分けしてプロットする
#ラベル(市町村名＝DFfaの行の名前)を rownames(DFfa) で表示
#クラスタの色名color.kmFAで色分けをして表示
plot(DFfa$ビジネス度,
     DFfa$都会生活度, type=&quot;n&quot;)
text(DFfa$ビジネス度,
     DFfa$都会生活度, rownames(DFfa), col=color.kmFA)
lines(c(-10, 10), c(0, 0), col=&quot;grey&quot;)
lines(c(0, 0), c(-10, 10), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<pre class="r"><code>plot(DFfa$非高齢化度,
     DFfa$都会生活度, type=&quot;n&quot;)
text(DFfa$非高齢化度,
     DFfa$都会生活度, rownames(DFfa), col=color.kmFA)
lines(c(-10, 10), c(0, 0), col=&quot;grey&quot;)
lines(c(0, 0), c(-10, 10), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" width="768" /></p>
</div>
<div id="比較用因子分析の有無によるkmeansの変化" class="section level3">
<h3>比較用：因子分析の有無によるkMeansの変化</h3>
<pre class="r"><code>DF_kmeans &lt;- DF[, -(1:3)] %&gt;% data.frame()
rownames(DF_kmeans) &lt;- DF[,1]

kmFA2 &lt;- kmeans(DF_kmeans, 4, iter.max=50)
require(cluster)</code></pre>
<pre><code>## Loading required package: cluster</code></pre>
<pre class="r"><code>clusplot(DF_kmeans,kmFA2$cluster,color=TRUE,shade = TRUE,labels=2,lines=0,main = &quot;因子分析なし&quot;,cex = 1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="768" /></p>
<pre class="r"><code>kmFA3 &lt;- kmeans(DFfa, 4, iter.max=50)
clusplot(DFfa,kmFA3$cluster,color=TRUE,shade = TRUE,labels=2,lines=0,main = &quot;因子分析あり&quot;,cex = 1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-2.png" width="768" /></p>
</div>
<div id="参考主成分分析を元にクラスタリング" class="section level3">
<h3>(参考)主成分分析を元にクラスタリング</h3>
<pre class="r"><code>#主成分分析
resultPCA &lt;- prcomp(DF[, -(1:3)], scale=TRUE)

#結果の要約
summary(resultPCA)</code></pre>
<pre><code>## Importance of components:
##                           PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     3.3971 2.1271 1.4791 1.27554 1.10198 0.84051 0.79699
## Proportion of Variance 0.4616 0.1810 0.0875 0.06508 0.04857 0.02826 0.02541
## Cumulative Proportion  0.4616 0.6426 0.7301 0.79518 0.84376 0.87201 0.89742
##                            PC8    PC9    PC10    PC11    PC12    PC13    PC14
## Standard deviation     0.76265 0.7053 0.61301 0.53764 0.45391 0.43334 0.36784
## Proportion of Variance 0.02327 0.0199 0.01503 0.01156 0.00824 0.00751 0.00541
## Cumulative Proportion  0.92069 0.9406 0.95562 0.96718 0.97542 0.98293 0.98835
##                           PC15    PC16    PC17    PC18   PC19    PC20    PC21
## Standard deviation     0.29898 0.27491 0.20076 0.17803 0.1413 0.11608 0.10136
## Proportion of Variance 0.00358 0.00302 0.00161 0.00127 0.0008 0.00054 0.00041
## Cumulative Proportion  0.99192 0.99495 0.99656 0.99783 0.9986 0.99916 0.99957
##                           PC22    PC23    PC24      PC25
## Standard deviation     0.07726 0.06019 0.03263 0.0002854
## Proportion of Variance 0.00024 0.00014 0.00004 0.0000000
## Cumulative Proportion  0.99981 0.99996 1.00000 1.0000000</code></pre>
<pre class="r"><code>#各変数ごとの主成分（固有ベクトル）
#第3主成分まで表示
resultPCA$rotation[, 1:3]</code></pre>
<pre><code>##                                            PC1          PC2          PC3
## 世帯あたり人数                      0.21817823  0.292007358  0.016652864
## 年齢15未満比率                      0.17315873  0.282854276  0.107643674
## 年齢65以上比率                      0.13827649  0.109660617 -0.462839305
## 転入者_対人口比                    -0.28134219 -0.035917394  0.057305951
## 転出者_対人口比                    -0.26794431 -0.117216398  0.117642903
## 昼間人口比_per                     -0.24316331  0.243126759 -0.063282831
## 高齢単身世帯比率                   -0.07399042 -0.218733757 -0.512410750
## 第1次産業従業者数比                 0.14312036  0.166901626  0.250632303
## 第2次産業従業者数比                 0.14036634  0.191454238 -0.128220532
## 第3次産業従業者数比                -0.14144537 -0.192633089  0.125130549
## 可住地面積比率                     -0.11383968 -0.257891119 -0.087326397
## 耕地面積_対可住面積比               0.15650544  0.244937181  0.128000027
## 課税所得_就業者1人あたり_千円      -0.23531538 -0.003764779  0.128319792
## 小売業販売額_事業所あたり_百万円   -0.18853341  0.053126273  0.272612089
## 小売業販売額_売場面積あたり_万円m2 -0.23711598 -0.087377992  0.069927304
## 国民健保一人あたり診療費_円         0.13891741  0.086561773 -0.327457796
## ごみリサイクル率_pct                0.14313231  0.127942834  0.261682729
## 千人あたり事業所数                 -0.25378255  0.219289176 -0.056588990
## 千人あたり幼稚園数                 -0.23505208  0.155132882 -0.083435715
## 千人あたり飲食店数                 -0.26230625  0.191112884 -0.023531861
## 千人あたり大型小売店数             -0.25021531  0.226389573  0.003021881
## 千人あたり病院数                   -0.15137829  0.284149431 -0.281049405
## 千人あたり老人ホーム数              0.12741348  0.292245219  0.020278499
## 千人あたり交通事故発生件数         -0.22590231  0.277312460 -0.014390255
## 千人あたり刑法犯認知件数           -0.24883963  0.187829606 -0.097897803</code></pre>
<pre class="r"><code>#各ケースごとの主成分得点
#5自治体、第3主成分まで表示
resultPCA$x[1:5, 1:3]</code></pre>
<pre><code>##             PC1         PC2        PC3
## [1,] -15.612740  8.44712230 -2.0311835
## [2,]  -7.096352  0.73514395  2.6988867
## [3,]  -7.229065  0.01595016  1.9002137
## [4,]  -4.511199 -2.09587518  0.8102051
## [5,]  -2.009200 -1.88536136 -0.3385769</code></pre>
<pre class="r"><code>#主成分得点(サンプルごとの点数)の値をタテヨコにプロットする
biplot(resultPCA,cex =1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<pre class="r"><code>#主成分得点をデータフレームに変換
DFpca &lt;- as.data.frame(resultPCA$x)
#行の名前を自治体名に変換
rownames(DFpca) &lt;- DF$市町村

#主成分得点について要約情報を表示
summary(DFpca)[, 1:2]</code></pre>
<pre><code>##       PC1                PC2         
##  Min.   :-15.6127   Min.   :-3.0900  
##  1st Qu.: -1.0704   1st Qu.:-1.1901  
##  Median :  0.6389   Median :-0.3572  
##  Mean   :  0.0000   Mean   : 0.0000  
##  3rd Qu.:  2.0853   3rd Qu.: 0.7376  
##  Max.   :  4.7703   Max.   : 8.4471</code></pre>
<pre class="r"><code>#標準偏差
apply(DFpca, 2, sd)[1:2]</code></pre>
<pre><code>##      PC1      PC2 
## 3.397107 2.127114</code></pre>
<pre class="r"><code>#主成分得点をもとにクラスタリング
#ここでは第3主成分までを使う
kmPCA &lt;- kmeans(DFpca[, 1:2], 4, iter.max=50)
#色ラベルの配列を作るためにクラスタ番号の配列をコピー
color.kmPCA &lt;- kmPCA$cluster
head(color.kmPCA)</code></pre>
<pre><code>## 千代田区   中央区     港区   新宿区   文京区   台東区 
##        4        1        1        1        3        1</code></pre>
<pre class="r"><code>#クラスタ番号を色名に変換する
#levels＝factor（カテゴリ変数）のラベルの指定
color.kmPCA &lt;- as.factor(color.kmPCA)
levels(color.kmPCA) &lt;- c(&quot;blue&quot;, &quot;red&quot;, &quot;green&quot;, &quot;orange&quot;)
head(color.kmPCA)</code></pre>
<pre><code>## 千代田区   中央区     港区   新宿区   文京区   台東区 
##   orange     blue     blue     blue    green     blue 
## Levels: blue red green orange</code></pre>
<pre class="r"><code>#factorの実体は整数型なので文字列に変換（ラベルの値が実体となる）
color.kmPCA &lt;- as.character(color.kmPCA)
head(color.kmPCA)</code></pre>
<pre><code>## [1] &quot;orange&quot; &quot;blue&quot;   &quot;blue&quot;   &quot;blue&quot;   &quot;green&quot;  &quot;blue&quot;</code></pre>
<pre class="r"><code>#主成分得点(サンプルごとの点数)の値を色分けしてプロットする
#ラベル(市町村名＝DFfaの行の名前)を rownames(DFpca) で表示
#クラスタの色名color.kmFAで色分けをして表示
plot(DFpca$PC1, DFpca$PC2, type=&quot;n&quot;)
text(DFpca$PC1, DFpca$PC2, rownames(DFpca), col=color.kmPCA, cex = 1)
lines(c(-20, 20), c(0, 0), col=&quot;grey&quot;)
lines(c(0, 0), c(-10, 10), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-2.png" width="768" /></p>
<!-- #結果の保存 -->
<!-- #元のデータに因子得点とクラスタ番号を付加 -->
<!-- DF <- cbind(DF, DFfa)          #列どうしを結合 -->
<!-- DF$kmFA <- color.kmFA          #色の名前で付加 -->
<!-- #元のデータに主成分得点（第2まで）とクラスタ番号を付加 -->
<!-- DF <- cbind(DF, DFpca[, 1:2])  #列どうしを結合 -->
<!-- DF$kmPCA <- color.kmPCA        #色の名前で付加 -->
<!-- #データを確認して保存 -->
<!-- str(DF) -->
<!-- write.table(DF, row.names=F, -->
<!--             file="TokyoSTAT_fa_pca.csv") -->
</div>
</div>
<div id="回帰分析" class="section level2">
<h2>４．回帰分析</h2>
<div id="目的変数の分布を確認" class="section level3">
<h3>目的変数の分布を確認</h3>
<pre class="r"><code>#元のデータに因子得点とクラスタ番号を付加
DF &lt;- cbind(DF, DFfa)          #列どうしを結合
DF$kmFA &lt;- color.kmFA          #色の名前で付加

#人気度の分布
summary(DF$人気度)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   11.00   21.00   39.50   61.38   82.25  214.00</code></pre>
<pre class="r"><code>#分布の確認
hist(DF$人気度,      col=&quot;ivory3&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
<pre class="r"><code>#偏っているので、対数をとる
hist(log(DF$人気度), col=&quot;ivory3&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-12-2.png" width="768" /></p>
<pre class="r"><code>#クラスタごとの人気度の分布
boxplot(log(DF$人気度) ~ DF$kmFA, col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-12-3.png" width="768" /></p>
</div>
<div id="回帰分析因子を使わないパターン" class="section level3">
<h3>回帰分析（因子を使わないパターン）</h3>
<ul>
<li>Estimate:パラメータの推定値</li>
<li>p-value:モデルの有意確率（モデル全体について）　5%以上だと×</li>
<li>t value:パラメータの推定値を標準誤差で割ったもの。</li>
<li>Pr(&gt;|t|):パラメータ毎の有意確率（本当は0なのに偶然値が出た確率。5%以上だと×）</li>
<li>あてはまりは良いが、有意なパラメータは「ゴミリサイクル率」のみ→過適合や多重共線性の疑い</li>
</ul>
<pre class="r"><code>Lm1 &lt;- lm(log(人気度) ~ ., data=DF[, c(3:28)])
summary(Lm1,digits = 2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(人気度) ~ ., data = DF[, c(3:28)])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.60277 -0.13619  0.00777  0.12467  0.56727 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)                        -1.408e+03  1.569e+03  -0.898  0.37832   
## 世帯あたり人数                     -2.532e+00  1.630e+00  -1.554  0.13336   
## 年齢15未満比率                      7.092e+00  1.443e+01   0.491  0.62763   
## 年齢65以上比率                     -1.678e+00  1.087e+01  -0.154  0.87855   
## 転入者_対人口比                     9.518e-01  2.235e+01   0.043  0.96639   
## 転出者_対人口比                     1.418e+01  2.728e+01   0.520  0.60790   
## 昼間人口比_per                      1.929e-03  1.942e-03   0.993  0.33051   
## 高齢単身世帯比率                   -4.455e+00  1.340e+01  -0.332  0.74245   
## 第1次産業従業者数比                 1.297e+03  1.593e+03   0.814  0.42356   
## 第2次産業従業者数比                 1.415e+03  1.568e+03   0.902  0.37601   
## 第3次産業従業者数比                 1.416e+03  1.568e+03   0.903  0.37551   
## 可住地面積比率                     -6.632e-01  7.389e-01  -0.898  0.37833   
## 耕地面積_対可住面積比              -2.334e-01  2.189e+00  -0.107  0.91596   
## 課税所得_就業者1人あたり_千円       3.493e-05  1.047e-04   0.334  0.74144   
## 小売業販売額_事業所あたり_百万円    1.109e-03  1.984e-03   0.559  0.58145   
## 小売業販売額_売場面積あたり_万円m2 -2.282e-03  5.210e-03  -0.438  0.66523   
## 国民健保一人あたり診療費_円         7.340e-06  8.593e-06   0.854  0.40148   
## ごみリサイクル率_pct               -2.922e-02  9.830e-03  -2.973  0.00662 **
## 千人あたり事業所数                 -2.546e-03  1.083e-02  -0.235  0.81610   
## 千人あたり幼稚園数                  2.685e-01  3.265e+00   0.082  0.93514   
## 千人あたり飲食店数                 -6.601e-03  6.039e-02  -0.109  0.91387   
## 千人あたり大型小売店数             -1.874e+00  2.092e+00  -0.896  0.37926   
## 千人あたり病院数                   -2.905e+00  3.407e+00  -0.853  0.40221   
## 千人あたり老人ホーム数              2.385e+00  3.670e+00   0.650  0.52193   
## 千人あたり交通事故発生件数          1.135e-01  8.522e-02   1.332  0.19524   
## 千人あたり刑法犯認知件数           -5.651e-03  1.891e-02  -0.299  0.76771   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3286 on 24 degrees of freedom
## Multiple R-squared:  0.9284, Adjusted R-squared:  0.8538 
## F-statistic: 12.45 on 25 and 24 DF,  p-value: 1.595e-08</code></pre>
<p>多重共線性の確認 - 変数が他の変数で説明できるか？の指標</p>
<pre class="r"><code>#VIFは10を超えていると相関が高すぎる＝多重共線性が発生しているとされる
car::vif(Lm1)</code></pre>
<pre><code>##                     世帯あたり人数                     年齢15未満比率 
##                       8.865640e+01                       3.745960e+01 
##                     年齢65以上比率                    転入者_対人口比 
##                       1.911331e+01                       1.320354e+02 
##                    転出者_対人口比                     昼間人口比_per 
##                       9.423737e+01                       1.006671e+02 
##                   高齢単身世帯比率                第1次産業従業者数比 
##                       1.442162e+01                       7.027825e+02 
##                第2次産業従業者数比                第3次産業従業者数比 
##                       6.122394e+06                       6.157581e+06 
##                     可住地面積比率              耕地面積_対可住面積比 
##                       4.632800e+00                       6.407427e+00 
##      課税所得_就業者1人あたり_千円   小売業販売額_事業所あたり_百万円 
##                       2.925883e+01                       1.874163e+01 
## 小売業販売額_売場面積あたり_万円m2        国民健保一人あたり診療費_円 
##                       4.046214e+01                       4.680362e+00 
##               ごみリサイクル率_pct                 千人あたり事業所数 
##                       4.847675e+00                       6.723542e+02 
##                 千人あたり幼稚園数                 千人あたり飲食店数 
##                       5.642512e+00                       2.618992e+02 
##             千人あたり大型小売店数                   千人あたり病院数 
##                       1.608345e+02                       1.123531e+01 
##             千人あたり老人ホーム数         千人あたり交通事故発生件数 
##                       7.919866e+00                       5.166385e+01 
##           千人あたり刑法犯認知件数 
##                       2.698357e+01</code></pre>
</div>
<div id="因子得点を使った回帰分析因子得点のみを説明変数に使う" class="section level3">
<h3>因子得点を使った回帰分析（因子得点のみを説明変数に使う）</h3>
<ul>
<li>すべての説明変数が有意(Prが5%未満)</li>
<li>都会生活度の回帰係数が最も大きく、人気度に影響する</li>
</ul>
<pre class="r"><code>Lm2 &lt;- lm(log(人気度) ~ ., data=DF[, c(3, 29:31)])
summary(Lm2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(人気度) ~ ., data = DF[, c(3, 29:31)])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.85922 -0.26027 -0.04871  0.28865  0.98502 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.75975    0.05591  67.244  &lt; 2e-16 ***
## ビジネス度   0.21443    0.05662   3.787  0.00044 ***
## 都会生活度   0.67453    0.05695  11.845 1.43e-15 ***
## 非高齢化度   0.31300    0.05755   5.439 1.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3954 on 46 degrees of freedom
## Multiple R-squared:  0.8013, Adjusted R-squared:  0.7883 
## F-statistic: 61.82 on 3 and 46 DF,  p-value: 3.591e-16</code></pre>
<pre class="r"><code>#標準偏回帰係数βを算出
require(lm.beta)          #βを算出するライブラリ</code></pre>
<pre><code>## Loading required package: lm.beta</code></pre>
<pre class="r"><code>Lm2beta &lt;- lm.beta(Lm2)   #関数lm.beta()でβを計算
summary(Lm2beta)</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(人気度) ~ ., data = DF[, c(3, 29:31)])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.85922 -0.26027 -0.04871  0.28865  0.98502 
## 
## Coefficients:
##             Estimate Standardized Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.75975      0.00000    0.05591  67.244  &lt; 2e-16 ***
## ビジネス度   0.21443      0.24895    0.05662   3.787  0.00044 ***
## 都会生活度   0.67453      0.77860    0.05695  11.845 1.43e-15 ***
## 非高齢化度   0.31300      0.35753    0.05755   5.439 1.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3954 on 46 degrees of freedom
## Multiple R-squared:  0.8013, Adjusted R-squared:  0.7883 
## F-statistic: 61.82 on 3 and 46 DF,  p-value: 3.591e-16</code></pre>
<pre class="r"><code>#多重共線性の確認（相関のない因子を抽出したため1となる）
vif(Lm2)</code></pre>
<pre><code>## ビジネス度 都会生活度 非高齢化度 
##   1.000049   1.000037   1.000067</code></pre>
</div>
<div id="lm2による人気度予測結果理論的な推定値" class="section level3">
<h3>Lm2による人気度予測結果（理論的な推定値）</h3>
<pre class="r"><code>pred &lt;- predict(Lm2, newdata=DF)
#結果は対数化されているので、指数化して戻す
exp(pred)</code></pre>
<pre><code>##   千代田区     中央区       港区     新宿区     文京区     台東区     墨田区 
##  154.91330  164.11748  159.95251  149.70889  102.33261   86.43392   57.83513 
##     江東区     品川区     目黒区     大田区   世田谷区     渋谷区     中野区 
##   44.37177   83.17894  111.46583   46.72847   63.85676  185.99666  132.71143 
##     杉並区     豊島区       北区     荒川区     板橋区     練馬区     足立区 
##   97.67824  119.49625   62.84557   42.19740   49.08209   40.14222   25.49404 
##     葛飾区   江戸川区   八王子市     立川市   武蔵野市     三鷹市     青梅市 
##   26.41747   27.82753   18.43428   35.92869   76.49622   53.07712   10.39364 
##     府中市     昭島市     調布市     町田市   小金井市     小平市     日野市 
##   33.97742   22.52340   49.46195   19.57689   56.35827   31.40962   27.29376 
##   東村山市   国分寺市     国立市     福生市     狛江市   東大和市     清瀬市 
##   20.33244   51.34531   47.42981   29.98082   54.31014   19.81005   20.66471 
## 東久留米市 武蔵村山市     多摩市     稲城市     羽村市 あきる野市   西東京市 
##   21.77794   15.04207   24.21405   21.73554   19.03401   10.42980   31.35671 
##     瑞穂町 
##   11.46688</code></pre>
<pre class="r"><code>#実測値と理論上の推定値
plot(log(DF$人気度), pred, type=&quot;n&quot;)
text(log(DF$人気度), pred, DF$市町村, col=color.kmFA)
lines(c(0, 10), c(0, 10), col=&quot;grey&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="768" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
